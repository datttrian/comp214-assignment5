CREATE TABLE `gpnr_category` (
  `category_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `category_name` VARCHAR(255) NOT NULL,
  `category_description` TEXT,
  `parent_category_id` INT UNSIGNED,
  PRIMARY KEY (`category_id`),
  FOREIGN KEY (`parent_category_id`) REFERENCES `gpnr_category`(`category_id`)
);

CREATE TABLE `gpnr_payment_info` (
  `payment_info_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `payment_info_name` VARCHAR(255) NOT NULL,
  `card_number` VARCHAR(19) NOT NULL,
  `card_name` VARCHAR(255) NOT NULL,
  `card_expiration` DATE NOT NULL,
  `card_cvv` CHAR(4) NOT NULL,
  PRIMARY KEY (`payment_info_id`)
);

CREATE TABLE `gpnr_customer` (
  `customer_username` VARCHAR(255) NOT NULL,
  `customer_password` VARCHAR(255) NOT NULL,
  `customer_email` VARCHAR(255) NOT NULL,
  `customer_firstname` VARCHAR(255) NOT NULL,
  `customer_lastname` VARCHAR(255) NOT NULL,
  `customer_address` TEXT,
  `customer_phone` VARCHAR(20),
  `payment_info_id` INT UNSIGNED,
  PRIMARY KEY (`customer_username`),
  FOREIGN KEY (`payment_info_id`) REFERENCES `gpnr_payment_info`(`payment_info_id`)
);

CREATE TABLE `gpnr_product_attribute` (
  `product_attribute_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `product_attribute_name` VARCHAR(255) NOT NULL,
  `product_attribute_status` ENUM('active', 'inactive') NOT NULL DEFAULT 'active',
  `value` TEXT,
  PRIMARY KEY (`product_attribute_id`)
);

CREATE TABLE `gpnr_product` (
  `product_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `product_name` VARCHAR(255) NOT NULL,
  `product_description` TEXT,
  `product_created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `product_status` ENUM('available', 'out_of_stock', 'discontinued') NOT NULL DEFAULT 'available',
  `price` DECIMAL(10, 2) NOT NULL,
  `currency` CHAR(3) NOT NULL,
  `stock` INT UNSIGNED NOT NULL DEFAULT 0,
  `category_id` INT UNSIGNED,
  `product_attribute_id` INT UNSIGNED,
  PRIMARY KEY (`product_id`),
  FOREIGN KEY (`category_id`) REFERENCES `gpnr_category`(`category_id`),
  FOREIGN KEY (`product_attribute_id`) REFERENCES `gpnr_product_attribute`(`product_attribute_id`)
);

CREATE TABLE `gpnr_request` (
  `request_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `request_cost` DECIMAL(10, 2) NOT NULL,
  `request_quantity` INT UNSIGNED NOT NULL DEFAULT 1,
  `request_created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `request_status` ENUM('pending', 'processing', 'completed', 'cancelled') NOT NULL DEFAULT 'pending',
  `product_quantity` INT UNSIGNED NOT NULL DEFAULT 1,
  `message` TEXT,
  `customer_username` VARCHAR(255),
  `product_id` INT UNSIGNED,
  PRIMARY KEY (`request_id`),
  FOREIGN KEY (`customer_username`) REFERENCES `gpnr_customer`(`customer_username`),
  FOREIGN KEY (`product_id`) REFERENCES `gpnr_product`(`product_id`)
);

CREATE TABLE `gpnr_shipper` (
  `shipper_username` VARCHAR(255) NOT NULL,
  `shipper_password` VARCHAR(255) NOT NULL,
  `shipper_email` VARCHAR(255) NOT NULL,
  `shipper_firstname` VARCHAR(255) NOT NULL,
  `shipper_lastname` VARCHAR(255) NOT NULL,
  `shipper_phone` VARCHAR(20),
  `shipper_rating` DECIMAL(3, 2) NOT NULL DEFAULT 0,
  PRIMARY KEY (`shipper_username`)
);

CREATE TABLE `gpnr_shipping` (
  `shipping_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `shipping_date` DATETIME NOT NULL,
  `shipping_address` TEXT,
  `shipping_status` ENUM('shipped', 'delivered') NOT NULL DEFAULT 'shipped',
  `shipping_cost` DECIMAL(10, 2) NOT NULL,
  `shipping_rating` DECIMAL(3, 2) NOT NULL DEFAULT 0,
  `shipper_username` VARCHAR(255),
  PRIMARY KEY (`shipping_id`),
  FOREIGN KEY (`shipper_username`) REFERENCES `gpnr_shipper`(`shipper_username`)
);

CREATE TABLE `gpnr_cart` (
  `cart_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `cart_status` ENUM('active', 'completed', 'cancelled') NOT NULL DEFAULT 'active',
  `cart_created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `cart_promotion` DECIMAL(10, 2) NOT NULL DEFAULT 0,
  `total` DECIMAL(10, 2) NOT NULL,
  `tax` DECIMAL(10, 2) NOT NULL DEFAULT 0,
  `product_quantity` INT UNSIGNED NOT NULL DEFAULT 1,
  `customer_username` VARCHAR(255),
  `product_id` INT UNSIGNED,
  `shipping_id` INT UNSIGNED,
  PRIMARY KEY (`cart_id`),
  FOREIGN KEY (`customer_username`) REFERENCES `gpnr_customer`(`customer_username`),
  FOREIGN KEY (`product_id`) REFERENCES `gpnr_product`(`product_id`),
  FOREIGN KEY (`shipping_id`) REFERENCES `gpnr_shipping`(`shipping_id`)
);

CREATE TABLE `gpnr_supplier` (
  `supplier_username` VARCHAR(255) NOT NULL,
  `supplier_password` VARCHAR(255) NOT NULL,
  `supplier_email` VARCHAR(255) NOT NULL,
  `supplier_firstname` VARCHAR(255) NOT NULL,
  `supplier_lastname` VARCHAR(255) NOT NULL,
  `supplier_phone` VARCHAR(20),
  PRIMARY KEY (`supplier_username`)
);

CREATE TABLE `gpnr_supplier_product` (
  `supplier_username` VARCHAR(255),
  `product_id` INT UNSIGNED,
  PRIMARY KEY (`supplier_username`, `product_id`),
  FOREIGN KEY (`product_id`) REFERENCES `gpnr_product`(`product_id`),
  FOREIGN KEY (`supplier_username`) REFERENCES `gpnr_supplier`(`supplier_username`)
);

CREATE TABLE `gpnr_promotion` (
  `promotion_id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `promotion_name` VARCHAR(255) NOT NULL,
  `start_date` DATE NOT NULL,
  `end_date` DATE NOT NULL,
  `amount` DECIMAL(10, 2) NOT NULL,
  PRIMARY KEY (`promotion_id`)
);

CREATE TABLE `gpnr_customer_promotion` (
  `promotion_id` INT UNSIGNED,
  `customer_username` VARCHAR(255),
  PRIMARY KEY (`promotion_id`, `customer_username`),
  FOREIGN KEY (`customer_username`) REFERENCES `gpnr_customer`(`customer_username`),
  FOREIGN KEY (`promotion_id`) REFERENCES `gpnr_promotion`(`promotion_id`)
);
